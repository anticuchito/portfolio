---
import Layout from "../layouts/Layout.astro";
import { basics } from "../lib/data";
import Skill from "../components/Skills.astro";
import {
    categoryOrder,
    getSkillsByCategory,
    getTopAndOtherSkills,
} from "../lib/skills";

const personalSummary =
    "Cuando no estoy programando, me gusta hacer música con sintetizadores analogicos y explorar nuevas tecnologías. También me gusta leer e ir a conciertos";

const { topSkillsList, otherSkillsList } = getTopAndOtherSkills();
---

<Layout title="About | Portfolio">
    <div class="max-w-3xl">
        <h1 class="text-4xl md:text-5xl font-bold mb-8">
            ABOUT <span class="accent">//</span>
        </h1>

        <div class="space-y-8">
            <section class="box-brutal p-8">
                <h2 class="text-2xl font-bold mb-4">¿QUIÉN SOY?</h2>
                <p class="text-secondary leading-relaxed mb-4">
                    {basics.summary}
                </p>
                <p class="text-secondary leading-relaxed">
                    {personalSummary}
                </p>
            </section>

            <section class="box-brutal p-8">
                <h2 class="text-2xl font-bold mb-6">HABILIDADES</h2>

                <!-- Top Skills -->
                <div id="top-skills">
                    {
                        categoryOrder.map((category: string) => {
                            const categorySkills =
                                getSkillsByCategory(category);
                            const visibleSkills = categorySkills.filter((s) =>
                                topSkillsList.some((ts) => ts.name === s.name),
                            );
                            if (visibleSkills.length === 0) return null;
                            return (
                                <div class="mb-6 last:mb-0">
                                    <h3 class="text-lg font-bold mb-4 text-secondary uppercase tracking-wider">
                                        {category}
                                    </h3>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        {visibleSkills.map((skill) => (
                                            <Skill skill={skill} />
                                        ))}
                                    </div>
                                </div>
                            );
                        })
                    }
                </div>

                <!-- Otras Skills (ocultas inicialmente) -->
                <div
                    id="other-skills"
                    class="hidden mt-6 pt-6 border-t-4 border-brutal"
                >
                    <h3
                        class="text-lg font-bold mb-4 text-secondary uppercase tracking-wider"
                    >
                        Otras habilidades
                    </h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        {
                            otherSkillsList.map((skill) => (
                                <Skill skill={skill} />
                            ))
                        }
                    </div>
                </div>

                <!-- Botón Ver todas -->
                <button
                    id="toggle-skills-btn"
                    class="btn-brutal w-full mt-6 text-center"
                    aria-expanded="false"
                    aria-controls="other-skills"
                >
                    <span id="toggle-text">Ver todas las habilidades ↓</span>
                </button>
            </section>

            <section class="box-brutal p-8">
                <h2 class="text-2xl font-bold mb-4">INTERESES</h2>
                <ul class="list-disc list-inside space-y-2 text-secondary">
                    <li>[Interés 1]</li>
                    <li>[Interés 2]</li>
                    <li>[Interés 3]</li>
                    <li>[Interés 4]</li>
                </ul>
            </section>

            <div class="flex gap-4 flex-wrap">
                <a href="/experiencia" class="btn-brutal">
                    → VER EXPERIENCIA
                </a>
                <a href="/contacto" class="btn-brutal"> → CONTACTAR </a>
            </div>
        </div>
    </div>

    <script>
        const toggleBtn = document.getElementById("toggle-skills-btn");
        const otherSkills = document.getElementById("other-skills");
        const toggleText = document.getElementById("toggle-text");

        toggleBtn?.addEventListener("click", () => {
            const isExpanded =
                toggleBtn.getAttribute("aria-expanded") === "true";

            if (isExpanded) {
                otherSkills?.classList.add("hidden");
                toggleBtn.setAttribute("aria-expanded", "false");
                if (toggleText)
                    toggleText.textContent = "Ver todas las habilidades ↓";
            } else {
                otherSkills?.classList.remove("hidden");
                toggleBtn.setAttribute("aria-expanded", "true");
                if (toggleText) toggleText.textContent = "Ver menos ↑";
            }
        });
    </script>
</Layout>
